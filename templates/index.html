<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask MVC CRUD</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
        input, button { margin: 5px; padding: 5px; }
    </style>
</head>
<body>
    <h1>Flask MVC CRUD</h1>

    <h2>Create User</h2>
    <input type="text" id="name" placeholder="Name">
    <input type="email" id="email" placeholder="Email">
    <button onclick="createUser()">Create</button>

    <h2>Users</h2>
    <table id="usersTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

<script>
const apiBase = '/users';

// Fetch and display all users
async function getUsers() {
    const res = await fetch(apiBase);
    const users = await res.json();
    const tbody = document.querySelector('#usersTable tbody');
    tbody.innerHTML = '';
    users.forEach(user => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${user.id}</td>
            <td><input type="text" value="${user.name}" id="name-${user.id}"></td>
            <td><input type="email" value="${user.email}" id="email-${user.id}"></td>
            <td>
                <button onclick="updateUser(${user.id})">Update</button>
                <button onclick="deleteUser(${user.id})">Delete</button>
            </td>
        `;
        tbody.appendChild(row);
    });
}

// Create a new user
async function createUser() {
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    await fetch(apiBase, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({name, email})
    });
    document.getElementById('name').value = '';
    document.getElementById('email').value = '';
    getUsers();
}

// Update user
async function updateUser(id) {
    const name = document.getElementById(`name-${id}`).value;
    const email = document.getElementById(`email-${id}`).value;
    await fetch(`${apiBase}/${id}`, {
        method: 'PUT',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({name, email})
    });
    getUsers();
}

// Delete user
async function deleteUser(id) {
    await fetch(`${apiBase}/${id}`, { method: 'DELETE' });
    getUsers();
}

// Initial load
getUsers();
</script>
</body>
</html>
